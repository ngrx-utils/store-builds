{"version":3,"file":"store.js","sources":["../../../modules/store/src/module.ts","../../../modules/store/src/select.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { NgrxSelect } from './select';\n\n@NgModule({\n  providers: [NgrxSelect]\n})\nexport class NgrxUtilsModule {}\n","import { Injectable } from '@angular/core';\nimport { Store } from '@ngrx/store';\nimport { map } from 'rxjs/operator/map';\nimport { pluck } from 'rxjs/operator/pluck';\nimport { distinctUntilChanged } from 'rxjs/operator/distinctUntilChanged';\n\n@Injectable()\nexport class NgrxSelect {\n  /**\n   * @internal\n   */\n  static store: Store<any> | undefined = undefined;\n\n  connect(store: Store<any>) {\n    NgrxSelect.store = store;\n  }\n}\n\nexport function Select<T, K>(mapFn: (state: T) => K): (target: any, name: string) => void;\nexport function Select(key?: string, ...paths: string[]): (target: any, name: string) => void;\nexport function Select<T, K>(pathOrMapFn?: ((state: T) => K) | string, ...paths: string[]) {\n  return function(target: any, name: string): void {\n    let mapped$: Store<any>;\n    const source$ = NgrxSelect.store;\n\n    if (!source$) {\n      throw new Error('NgrxSelect not connected to store!');\n    }\n\n    if (!pathOrMapFn) {\n      pathOrMapFn = name;\n    }\n\n    if (typeof pathOrMapFn === 'string') {\n      mapped$ = pluck.call(source$, pathOrMapFn, ...paths);\n    } else if (typeof pathOrMapFn === 'function') {\n      mapped$ = map.call(source$, pathOrMapFn);\n    } else {\n      throw new TypeError(\n        `Unexpected type '${typeof pathOrMapFn}' in select operator,` + ` expected 'string' or 'function'`\n      );\n    }\n    if (delete target[name]) {\n      Object.defineProperty(target, name, {\n        get: () => {\n          return distinctUntilChanged.call(mapped$);\n        },\n        enumerable: true,\n        configurable: true\n      });\n    }\n  };\n}\n"],"names":["distinctUntilChanged","map","pluck"],"mappings":";;;;;;;;;ACAA,AAOA,MAAA,UAAA,CAAA;;;;;IAME,OAAO,CAAC,KAAiB,EAA3B;QACI,UAAU,CAAC,KAAK,GAAG,KAAK,CAAC;KAC1B;;;;;AAJH,UAAA,CAAA,KAAA,GAAyC,SAAS,CAAlD;;IALA,EAAA,IAAA,EAAC,UAAU,EAAX;;;;;;;;;;AAcA,AAAA,SAAA,MAAA,CAA6B,WAAwC,EAAE,GAAG,KAAe,EAAzF;IACE,OAAO,UAAS,MAAW,EAAE,IAAY,EAA3C;QACI,qBAAI,OAAmB,CAAC;QACxB,uBAAM,OAAO,GAAG,UAAU,CAAC,KAAK,CAAC;QAEjC,IAAI,CAAC,OAAO,EAAE;YACZ,MAAM,IAAI,KAAK,CAAC,oCAAoC,CAAC,CAAC;SACvD;QAED,IAAI,CAAC,WAAW,EAAE;YAChB,WAAW,GAAG,IAAI,CAAC;SACpB;QAED,IAAI,OAAO,WAAW,KAAK,QAAQ,EAAE;YACnC,OAAO,GAAGE,OAAK,CAAC,IAAI,CAAC,OAAO,EAAE,WAAW,EAAE,GAAG,KAAK,CAAC,CAAC;SACtD;aAAM,IAAI,OAAO,WAAW,KAAK,UAAU,EAAE;YAC5C,OAAO,GAAGD,KAAG,CAAC,IAAI,CAAC,OAAO,EAAE,WAAW,CAAC,CAAC;SAC1C;aAAM;YACL,MAAM,IAAI,SAAS,CACjB,CADR,iBAAA,EAC4B,OAAO,WAAW,CAD9C,qBAAA,CACqE,GAAG,CADxE,gCAAA,CAC0G,CACnG,CAAC;SACH;QACD,IAAI,OAAO,MAAM,CAAC,IAAI,CAAC,EAAE;YACvB,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,IAAI,EAAE;gBAClC,GAAG,EAAE,MAAb;oBACU,OAAOD,sBAAoB,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;iBAC3C;gBACD,UAAU,EAAE,IAAI;gBAChB,YAAY,EAAE,IAAI;aACnB,CAAC,CAAC;SACJ;KACF,CAAC;CACH;;;;;;ADpDD,AAMA,MAAA,eAAA,CAAA;;;IAHA,EAAA,IAAA,EAAC,QAAQ,EAAT,IAAA,EAAA,CAAU;gBACR,SAAS,EAAE,CAAC,UAAU,CAAC;aACxB,EAAD,EAAA;;;;;;;;;;;;;;;;;;;;;;;;;"}